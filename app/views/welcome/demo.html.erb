<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <title>DEMO|SoshineSee</title>

  <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=NccogPfKH2hGdsARVdK7lsVvNao7Y4Hm"></script>
  <script type="text/javascript" src="/demo/convertor.js"></script>
  <script type="text/javascript" src="http://api.map.baidu.com/library/DistanceTool/1.2/src/DistanceTool_min.js"></script>
  <!--加载鼠标绘制工具-->
  <script type="text/javascript" src="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js"></script>
  <link rel="stylesheet" href="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css" />
  <!--加载检索信息窗口-->
  <script type="text/javascript" src="http://api.map.baidu.com/library/SearchInfoWindow/1.4/src/SearchInfoWindow_min.js"></script>
  <link rel="stylesheet" href="http://api.map.baidu.com/library/SearchInfoWindow/1.4/src/SearchInfoWindow_min.css" />
  <!--加载检索信息窗口-->
  <script type="text/javascript" src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
  <script type="text/javascript" src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>




</head>
<body class="demo">
<div class="container">
  <div class="row clearfix">
    <!--侧边栏-->
    <div class="col-md-2 column">
      <!--侧边栏|折叠-->
      <div class="panel-group" id="panel-100">
        <div class="panel panel-default">
          <div class="panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">地块列表</h3>
            </div>
          </div>

          <!--地块列表|博罗细1-9块-->
          <div class="panel-heading">
            <a class="panel-title" data-toggle="collapse" data-parent="#panel-100"
               href="#panel-element-demo-Boluo-A" onclick="focus_Demo_Block_Boluo_A()">博罗县示例地块A</a>
          </div>
          <div id="panel-element-demo-Boluo-A" class="panel-collapse collapse">
            <div id="Demo_Block_Boluo_A_01" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_01()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_01()">区域01|8水塘</a>
            </div>
            <div id="Demo_Block_Boluo_A_02" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_02()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_02()">区域02|1住宅+8水塘</a>
            </div>
            <div id="Demo_Block_Boluo_A_03" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_03()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_03()">区域03|4水塘</a>
            </div>
            <div id="Demo_Block_Boluo_A_04" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_04()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_04()">区域04|1住宅+10水塘</a>
            </div>
            <div id="Demo_Block_Boluo_A_06" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_05()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_05()">区域05|5干涸水塘+1水塘</a>
            </div>
            <div id="Demo_Block_Boluo_A_06" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_06()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_06()">区域06|1干涸水塘+3水塘</a>
            </div>
            <div id="Demo_Block_Boluo_A_07" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_07()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_07()">区域07|水塘夹角三角区农田</a>
            </div>
            <div id="Demo_Block_Boluo_A_08" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_08()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_08()">区域08|未灌溉农田</a>
            </div>
            <div id="Demo_Block_Boluo_A_09" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_09()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_09()">区域09|灌溉农田</a>
            </div>
            <div id="Demo_Block_Boluo_A_10" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_A_10()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_A_10()">区域10|2干涸水塘+8水塘</a>
            </div>
          </div>

          <!--地块列表|博罗细2-3块-->
          <div class="panel-heading">
            <a class="panel-title" data-toggle="collapse" data-parent="#panel-100"
               href="#panel-element-demo-Boluo-B" onclick="focus_Demo_Block_Boluo_B()">博罗县示例地块B</a>
          </div>
          <div id="panel-element-demo-Boluo-B" class="panel-collapse collapse">
            <div id="Demo_Block_Boluo_B_01" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_B_01()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_B_01()">区域01|北农田</a>
            </div>
            <div id="Demo_Block_Boluo_B_02" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_B_02()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_B_02()">区域02|西农田</a>
            </div>
            <div id="Demo_Block_Boluo_B_03" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_B_03()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_B_03()">区域03|东农田</a>
            </div>
          </div>

          <!--地块列表|博罗细3-4块-->
          <div class="panel-heading">
            <a class="panel-title" data-toggle="collapse" data-parent="#panel-100"
               href="#panel-element-demo-Boluo-C" onclick="focus_Demo_Block_Boluo_C()">博罗县示例地块C</a>
          </div>
          <div id="panel-element-demo-Boluo-C" class="panel-collapse collapse">
            <div id="Demo_Block_Boluo_C_01" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_C_01()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_C_01()">区域01|跨树林农田</a>
            </div>
            <div id="Demo_Block_Boluo_C_02" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_C_02()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_C_02()">区域02|小块农田</a>
            </div>
            <div id="Demo_Block_Boluo_C_03" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Boluo_C_03()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Boluo_C_03()">区域03|东农田</a>
            </div>
          </div>

          <!--地块列表|涿州细1-3块-->
          <div class="panel-heading">
            <a class="panel-title" data-toggle="collapse" data-parent="#panel-100"
               href="#panel-element-demo-Zhuo-A" onclick="focus_Demo_Block_Zhuo_A()">涿州县示例地块A</a>
          </div>
          <div id="panel-element-demo-Zhuo-A" class="panel-collapse collapse">
            <div id="Demo_Block_Zhuo_A_01" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Zhuo_A_01()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Zhuo_A_01()">区域01|西农田</a>
            </div>
            <div id="Demo_Block_Zhuo_A_02" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Zhuo_A_02()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Zhuo_A_02()">区域02|东农田</a>
            </div>
            <div id="Demo_Block_Zhuo_A_03" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Zhuo_A_03()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Zhuo_A_03()">区域03|南农田</a>
            </div>
          </div>

          <!--地块列表|涿州细2-3块-->
          <div class="panel-heading">
            <a class="panel-title" data-toggle="collapse" data-parent="#panel-100"
               href="#panel-element-demo-Zhuo-B" onclick="focus_Demo_Block_Zhuo_B()">涿州县示例地块B</a>
          </div>
          <div id="panel-element-demo-Zhuo-B" class="panel-collapse collapse">
            <div id="Demo_Block_Zhuo_B_01" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Zhuo_B_01()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Zhuo_B_01()">区域01|西农田</a>
            </div>
            <div id="Demo_Block_Zhuo_B_02" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Zhuo_B_02()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Zhuo_B_02()">区域02|东农田</a>
            </div>
            <div id="Demo_Block_Zhuo_B_03" class="panel-body"
                 onmouseover="add_OutlineOverlay_Demo_Block_Zhuo_B_03()" onmouseout="remove_OutlineOverlay()">
              <a class="btn-link" onclick="focus_Demo_Block_Zhuo_B_03()">区域03|北农田</a>
            </div>
          </div>

        </div>
      </div>

      <!--侧边栏|信息-->
      <div class="info">
        <div class="panel panel-primary">
          <div class="panel-heading">
            <h3 class="panel-title">地块信息</h3>
          </div>
          <div class="panel-body">
            <h5 id="blockname"> <br> </h5>
            <h5 id="corpinfo"> <br> </h5>
            <h5 id="timeinfo"> <br> </h5>
          </div>
          <div class="panel-footer">
            <h5 id="locinfo"> <br> </h5>
          </div>
        </div>
      </div>


    </div>
    <!--主体-->
    <div class="col-md-10 column">

      <div id="hdmap">
        <div id="hdmapinfo">
          <h3 class="hdmapinfo-content">博罗县地块A01</h3>
          <div class="alert alert-info" id="hdmapinfo-status">
            状态:正常
          </div>
          <table>
            <tr>
              <td class="hdmapinfo-td">N:23.129632 </td>
              <td class="hdmapinfo-td">S:23.127825 </td>
            </tr>
            <tr>
              <td class="hdmapinfo-td">W:114.203604 </td>
              <td class="hdmapinfo-td">E:114.205437 </td>
            </tr>
          </table>

          <h6 class="hdmapinfo-content">面积:22388㎡</h6>
          <h6 class="hdmapinfo-content">日期:2016/03/15</h6>
          <h6 class="hdmapinfo-content">作物:玉米</h6>
          <p class="hdmapinfo-content">
            无
          </p>

          <button type="button" class="btn btn-default btn-xs" id="btn_close" data-toggle="tooltip"
                  data-placement="right" title="close"  onclick="btn_close()">
            CLOSE
          </button>
        </div>
        <img id="hdimg" src="/assets/demo/hd/nohdimg.png" >
      </div>
      <!--地图-->
      <div class="jumbotron">
          <div id="allmap">
          </div>
      </div>

      <!--日期-->

      <!--类型-->
      <div class="btn-group-vertical" id="mapchoice">
        <button type="button" class="btn btn-default" id="btn_nc" data-toggle="tooltip"
                data-placement="right" title="高清航拍图" onclick="btn_nc()">可见光</button>
        <button type="button" class="btn btn-default" id="btn_infrared" data-toggle="tooltip"
                data-placement="right" title="红外线图" onclick="btn_infrared()">红外线</button>
        <button type="button" class="btn btn-default" id="btn_ndvi" data-toggle="tooltip"
                data-placement="right" title="NDVI图" onclick="btn_ndvi()">NDVI</button>
        <button type="button" class="btn btn-default" id="btn_val" data-toggle="tooltip"
                data-placement="right" title="VALUE图"  onclick="btn_val()">VAL</button>
        <button type="button" class="btn btn-default" id="btn_spec" data-toggle="tooltip"
                data-placement="right" title="地块特殊图" onclick="btn_spec()">SPEC</button>
        <br/>
        <button type="button" class="btn btn-default" id="btn_xy" data-toggle="tooltip"
                data-placement="right" title="获取点坐标"  onclick="btn_pointinfo()">坐标</button>
        <button type="button" class="btn btn-default" id="btn_draw" data-toggle="tooltip"
                data-placement="right" title="距离与面积"  onclick="btn_draw()">计算</button>
        <!--
        <button type="button" class="btn btn-default" id="btn_go" data-toggle="tooltip"
                data-placement="right" title="导航"  onclick="btn_go()">GO</button>

        <button type="button" class="btn btn-default" id="btn_hd" data-toggle="tooltip"
                data-placement="right" title="HD"  onclick="show_hd('/assets/demo/hd/Demo_Block_Boluo_C_1hd.png')">HD</button>
        -->
        <button type="button" class="btn btn-default" id="btn_clear" data-toggle="tooltip"
                data-placement="right" title="清除叠加图"  onclick="btn_clear()">清空</button>
      </div>


    </div>
  </div>
</div>
</body>

<script type="text/javascript">
  // 百度地图API功能 BMAP_NORMAL_MAP BMAP_HYBRID_MAP
  map = new BMap.Map("allmap",{mapType:BMAP_SATELLITE_MAP});    // 创建Map实例
  map.setCurrentCity("北京");          // 设置地图显示的城市 此项是必须设置的
  map.centerAndZoom(new BMap.Point(103, 34), 6);  // 初始化地图,设置中心点坐标和地图级别
  var top_left_type = new BMap.MapTypeControl({anchor: BMAP_ANCHOR_TOP_LEFT,offset: new BMap.Size(75,50)});
  var top_left_control = new BMap.ScaleControl({anchor: BMAP_ANCHOR_TOP_LEFT,offset: new BMap.Size(75,25)});// 左上角，添加比例尺
  var top_left_navigation = new BMap.NavigationControl();  //左上角，添加默认缩放平移控件
  map.addControl(top_left_type);   //添加地图类型控件
  map.addControl(top_left_control);
  map.addControl(top_left_navigation);
  map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放


  var B_AB01CM = new BMap.Point(114.204408,23.128789);
  var B_AB02CM = new BMap.Point(114.205338,23.129786);
  var B_AB03CM = new BMap.Point(114.206012,23.128955);
  var B_AB04CM = new BMap.Point(114.206344,23.130384);
  var B_AB05CM = new BMap.Point(114.207319,23.131506);
  var B_AB06CM = new BMap.Point(114.207305,23.129678);
  var B_AB07CM = new BMap.Point(114.208186,23.131206);
  var B_AB08CM = new BMap.Point(114.208608,23.132029);
  var B_AB09CM = new BMap.Point(114.209228,23.13153);
  var B_AB10CM = new BMap.Point(114.209461,23.130724);
  var B_BB01CM = new BMap.Point(114.205348,23.12603);
  var B_BB02CM = new BMap.Point(114.204818,23.125141);
  var B_BB03CM = new BMap.Point(114.206174,23.125316);
  var B_CB01CM = new BMap.Point(114.209395,23.128007);
  var B_CB02CM = new BMap.Point(114.210163,23.128115);
  var B_CB03CM = new BMap.Point(114.210199,23.129154);
  var Demo_Block_Zhuo_A_CM = new BMap.Point(115.992803,39.490072);
  var Demo_Block_Zhuo_B_CM = new BMap.Point(115.992803,39.493072);

  var myIcon = new BMap.Icon("/assets/demo/mkr_orange_20.png", new BMap.Size(20,27));

  var B_AB01CMkr = new BMap.Marker(B_AB01CM,{icon:myIcon});
  B_AB01CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_1hd.png");});
  var B_AB02CMkr = new BMap.Marker(B_AB02CM,{icon:myIcon});
  B_AB02CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_2hd.png");});
  var B_AB03CMkr = new BMap.Marker(B_AB03CM,{icon:myIcon});
  B_AB03CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_3hd.png");});
  var B_AB04CMkr = new BMap.Marker(B_AB04CM,{icon:myIcon});
  B_AB04CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_4hd.png");});
  var B_AB05CMkr = new BMap.Marker(B_AB05CM,{icon:myIcon});
  B_AB05CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_5hd.png");});
  var B_AB06CMkr = new BMap.Marker(B_AB06CM,{icon:myIcon});
  B_AB06CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_6hd.png");});
  var B_AB07CMkr = new BMap.Marker(B_AB07CM,{icon:myIcon});
  B_AB07CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_7hd.png");});
  var B_AB08CMkr = new BMap.Marker(B_AB08CM,{icon:myIcon});
  B_AB08CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_8hd.png");});
  var B_AB09CMkr = new BMap.Marker(B_AB09CM,{icon:myIcon});
  B_AB09CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_9hd.png");});
  var B_AB10CMkr = new BMap.Marker(B_AB10CM,{icon:myIcon});
  B_AB10CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_A_10hd.png");});

  var B_BB01CMkr = new BMap.Marker(B_BB01CM,{icon:myIcon});
  B_BB01CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_B_1hd.png");});
  var B_BB02CMkr = new BMap.Marker(B_BB02CM,{icon:myIcon});
  B_BB02CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_B_3hd.png");});
  var B_BB03CMkr = new BMap.Marker(B_BB03CM,{icon:myIcon});
  B_BB03CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_B_2hd.png");});


  var B_CB01CMkr = new BMap.Marker(B_CB01CM,{icon:myIcon});
  B_CB01CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_C_1hd.png");});
  var B_CB02CMkr = new BMap.Marker(B_CB02CM,{icon:myIcon});
  B_CB02CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_C_2hd.png");});
  var B_CB03CMkr = new BMap.Marker(B_CB03CM,{icon:myIcon});
  B_CB03CMkr.addEventListener("click",function(){show_hd("/assets/demo/hd/Demo_Block_Boluo_C_3hd.png");});

  var markers = [];
  markers.push(B_AB01CMkr);
  markers.push(B_AB02CMkr);
  markers.push(B_AB03CMkr);
  markers.push(B_AB04CMkr);
  markers.push(B_AB05CMkr);
  markers.push(B_AB06CMkr);
  markers.push(B_AB07CMkr);
  markers.push(B_AB08CMkr);
  markers.push(B_AB09CMkr);
  markers.push(B_AB10CMkr);
  markers.push(B_BB01CMkr);
  markers.push(B_BB02CMkr);
  markers.push(B_BB03CMkr);
  markers.push(B_CB01CMkr);
  markers.push(B_CB02CMkr);
  markers.push(B_CB03CMkr);
  markers.push(new BMap.Marker(Demo_Block_Zhuo_A_CM,{icon:myIcon}));
  markers.push(new BMap.Marker(Demo_Block_Zhuo_B_CM,{icon:myIcon}));
  var markerClusterer = new BMapLib.MarkerClusterer(map,{markers:markers});

  map.setMapStyle({
    styleJson:[
      {
        "featureType": "all",
        "elementType": "all",
        "stylers": {
          "lightness": 10,
          "saturation": -100
        }
      }
    ]
  });

  $(function () {$(function () { $("[data-toggle='tooltip']").tooltip(); });});

  currentblock = undefined;

  currentblock_has_nc = false;
  currentblock_has_infrared = false;
  currentblock_has_ndvi = false;
  currentblock_has_val = false;
  currentblock_has_spec = false;

  isGroundOverlay = false;
  polygon = new BMap.Polygon();
  //Only one Zone is present at a time
  zoneOverlay = undefined;
  //Only one Outline is present at a time
  outlineOverlay = undefined;

  flag_xy = -1;
  flag_calculate = -1;

  /* OutlineOverlay
   * Divided Block Outline
   * */
  var OutlinepolygonOptions = {
    strokeColor : "skyblue",
    strokeStyle : "dashed",
    strokeWeight : 2,
    strokeOpacity : 1,
    fillOpacity : 0.5,
    fillColor : "lightskyblue"
  };


  /*  drawingManager
  * Options
  * Instance
  * EventListener
  * */
  var styleOptions = {
    strokeColor:"skyblue",    //边线颜色。
    fillColor:"skyblue",      //填充颜色。当参数为空时，圆形将没有填充效果。
    strokeWeight: 2,       //边线的宽度，以像素为单位。
    strokeOpacity: 1,	   //边线透明度，取值范围0 - 1。
    fillOpacity: 0.5,      //填充的透明度，取值范围0 - 1。
    strokeStyle: 'dashed' //边线的样式，solid或dashed。
  };
  //drawingManager Instance
  var drawingManager = new BMapLib.DrawingManager(map, {
    isOpen: false, //是否开启绘制模式
    enableDrawingTool: true, //是否显示工具栏
    drawingToolOptions: {
      anchor: BMAP_ANCHOR_TOP_RIGHT, //位置
      offset: new BMap.Size(5, 5), //偏离值
    },
    enableCalculate: false,
    circleOptions: styleOptions, //圆的样式
    polylineOptions: styleOptions, //线的样式
    polygonOptions: styleOptions, //多边形的样式
    rectangleOptions: styleOptions //矩形的样式
  });
  //drawingManager Calculate Done
  drawingManager.addEventListener("overlaycomplete", function(e) {
    var mode = e.drawingMode;
    var result = e.calculate;
    var ep = e.label.getPosition();
    e.label.setStyle({display: "none"});
    var info = new BMap.InfoWindow('', {width: 260 , title: "绘制结果:"});

    if(flag_calculate == 1){
      if(mode == "polyline"){
        if(result<1000){info.setContent(result + "米");}
        else{info.setContent(result/1000 + "千米");}
      }
      else{
        if(result<1000000){info.setContent(result + "平方米");}
        else{info.setContent(result/1000000 + "平方千米");}
      }
      map.openInfoWindow(info, ep);
    }
  });

  /*  ZoneOverlay
  * for NC\NDVI\INFRARED\etc.. image
  * Can't work in other files
  * TO BE WORK OUT WHY
  */
  function ZoneOverlay(WN,ES,imageurl,alpha){
    this._WN = WN;
    this._ES = ES;
    this._imageurl = imageurl;
    this._alpha = alpha;
  }
  ZoneOverlay.prototype = new BMap.Overlay();
  ZoneOverlay.prototype.initialize = function(map){
    this._map = map;
    var div = document.createElement("div");
    div.style.position = "absolute";
    this._width = this._map.pointToOverlayPixel(this._ES).x - this._map.pointToOverlayPixel(this._WN).x;
    this._height = this._map.pointToOverlayPixel(this._ES).y - this._map.pointToOverlayPixel(this._WN).y;
    div.style.width = this._width + "px";
    div.style.height = this._height + "px";
    var image = document.createElement("img");
    image.src = this._imageurl;
    image.width = this._width;
    image.height = this._height;
    div.style.opacity = this._alpha;
    div.style.zIndex = -9999;
    div.appendChild(image);
    map.getPanes().mapPane.appendChild(div);
    this._div = div;
    return div;
  };
  ZoneOverlay.prototype.draw = function(){
    var position = this._map.pointToOverlayPixel(this._WN);
    this._div.style.left = position.x + "px";
    this._div.style.top = position.y + "px";
  };

  map.addEventListener("zoomstart",function(){
      map.removeOverlay(zoneOverlay);
  });
  map.addEventListener("zoomend",function(){
    map.addOverlay(zoneOverlay);
  });
  function refreshzone(){
    map.removeOverlay(zoneOverlay);
    map.addOverlay(zoneOverlay);
  }

  function btn_hd(){
    document.getElementById("hdmap").style.height="100%";
    document.getElementById("allmap").style.height="0";
  }

  function btn_close(){
    document.getElementById("hdmap").style.display="none";
    document.getElementById("allmap").style.display="block";
  }


  function show_hd(hdimageurl){
    var hdimg = document.getElementById("hdimg");
    hdimg.src = hdimageurl;
    document.getElementById("hdmap").style.display="block";
    //document.getElementById("hdmap").style.height ="auto";
    //document.getElementById("hdmap").style.width = "auto";
    //document.getElementById("hdmap").style.overflow="auto";
    document.getElementById("allmap").style.display="none";
  }
</script>
